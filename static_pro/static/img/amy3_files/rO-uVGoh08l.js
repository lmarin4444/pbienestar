if (self.CavalryLogger) { CavalryLogger.start_js(["fHANF"]); }

__d("Keyframes",["Promise","Bootloader","Deferred","NavigationMetrics","XHRRequest"],(function a(b,c,d,e,f,g){"use strict";var h={},i=new(c("Deferred"))(),j="tti";c("NavigationMetrics").addRetroactiveListener(c("NavigationMetrics").Events.EVENT_OCCURRED,function(w,x){var event=x.event;j=event;if(event==="all_pagelets_displayed")i.resolve()});function k(){return i.then(function(){return new(c("Promise"))(function(w){c("Bootloader").loadModules(["KeyframesRenderer"],function(x){return w(x)},"Keyframes")})})}function l(){return i.then(function(){return new(c("Promise"))(function(w){c("Bootloader").loadModules(["FBKeyframesLoggedSession"],function(x){return w(x)},"Keyframes")})})}function m(){return i.then(function(){return new(c("Promise"))(function(w){c("Bootloader").loadModules(["KeyframesEnvironment"],function(x){return w(x)},"Keyframes")})})}function n(){return i.then(function(){return new(c("Promise"))(function(w){c("Bootloader").loadModules(["KeyframesAssetDecoder"],function(x){return w(x)},"Keyframes")})})}function o(){return m().then(function(w){return w.whenRenderLoopHasBeenStableOnce()})}function p(w){if(!w||typeof w!=="string")return c("Promise").reject("Request: invalid uri "+w);return i.then(function(){return new(c("Promise"))(function(x,y){new(c("XHRRequest"))(w).setMethod("GET").setResponseType("arraybuffer").setErrorHandler(function(z){return y(z)}).setAbortHandler(function(z){return y(z)}).setResponseHandler(function(z){return x(z)}).send()})})}function q(w){return h[w]!=null}function r(w){if(h[w]==null)h[w]=new u(w);return h[w]}function s(){return{value:Date.now(),phase:j}}function t(w){this.$SessionStub1={start:s(),utilized:false};this.$SessionStub3=l().then(function(x){var y=new x("network",w,this.$SessionStub1.start);this.$SessionStub4(y);return y}.bind(this));this.$SessionStub3.done(function(x){return this.$SessionStub2=x}.bind(this))}t.prototype.getSession=function(){return this.$SessionStub3};t.prototype.$SessionStub4=function(w){if(this.$SessionStub1.assetRequest!=null){var x=w.startAssetRequest(this.$SessionStub1.assetRequest);if(this.$SessionStub1.assetRequestError!=null){x.error(this.$SessionStub1.assetRequestError);return}if(this.$SessionStub1.assetResponse!=null)x.loadedFromNetwork(this.$SessionStub1.assetResponse)}if(this.$SessionStub1.assetDecode!=null){var y=w.startAssetDecode(this.$SessionStub1.assetDecode);if(this.$SessionStub1.assetDecodeError!=null){y.error(this.$SessionStub1.assetDecodeError);return}if(this.$SessionStub1.finish!=null)y.finish(this.$SessionStub1.finish)}if(this.$SessionStub1.utilized)w.utilizeAsset()};t.prototype.startAssetDecode=function(){if(this.$SessionStub2)return this.$SessionStub2.startAssetDecode();else{this.$SessionStub1.assetDecode=s();return{finish:function(){if(this.$SessionStub2)this.$SessionStub2.startAssetDecode(this.$SessionStub1.assetDecode).finish(s());else this.$SessionStub1.finish=s()}.bind(this),error:function(){if(this.$SessionStub2)this.$SessionStub2.startAssetDecode(this.$SessionStub1.assetDecode).error(s());else this.$SessionStub1.assetDecodeError=s()}.bind(this)}}};t.prototype.startAssetRequest=function(){if(this.$SessionStub2)return this.$SessionStub2.startAssetRequest();else{this.$SessionStub1.assetRequest=s();var w=function(){if(this.$SessionStub2)return this.$SessionStub2.startAssetRequest(this.$SessionStub1.assetRequest).loadedFromNetwork(s());else{this.$SessionStub1.assetResponse=s();return{startAssetDecode:this.startAssetDecode.bind(this)}}}.bind(this),x=function(){if(this.$SessionStub2)this.$SessionStub2.startAssetRequest(this.$SessionStub1.assetRequest).error(s());else this.$SessionStub1.assetRequestError=s()}.bind(this);return{loadedFromCache:w,loadedFromNetwork:w,cancel:x,error:x}}};t.prototype.utilizeAsset=function(){if(this.$SessionStub2)this.$SessionStub2.utilizeAsset();else this.$SessionStub1.utilized=true};function u(w){this.$DecodedAssetRequest1=[];this.$DecodedAssetRequest3=[];this.$DecodedAssetRequest4=[];this.$DecodedAssetRequest5="requesting";this.$DecodedAssetRequest7=false;this.$DecodedAssetRequest6=w}u.prototype.isLoaded=function(){return this.$DecodedAssetRequest5==="done"};u.prototype.requestAsset=function(w){return this.$DecodedAssetRequest8(new t(w))};u.prototype.requestRenderer=function(w){var x=new t(w);return c("Promise").all([this.$DecodedAssetRequest8(x),x.getSession(),k(),o()]).then(function(y){var z=y[0],A=y[1],B=y[2];this.$DecodedAssetRequest9();return new B(z,A.getPerformanceLogIfEnabled())}.bind(this))};u.prototype.$DecodedAssetRequest9=function(){if(!this.$DecodedAssetRequest7){this.$DecodedAssetRequest4.forEach(function(w){return w.utilizeAsset()});this.$DecodedAssetRequest7=true}};u.prototype.$DecodedAssetRequest8=function(w){this.$DecodedAssetRequest4.push(w);if(this.$DecodedAssetRequest7)w.utilizeAsset();switch(this.$DecodedAssetRequest5){case"requesting":this.$DecodedAssetRequest3.push(w.startAssetRequest());break;case"decoding":this.$DecodedAssetRequest1.push(w.startAssetDecode());break}if(!this.$DecodedAssetRequest2)this.$DecodedAssetRequest2=c("Promise").all([p(this.$DecodedAssetRequest6),n()]).then(function(x){var y=x[0],z=x[1];this.$DecodedAssetRequest5="decoding";while(this.$DecodedAssetRequest3.length)this.$DecodedAssetRequest1.push(this.$DecodedAssetRequest3.pop().loadedFromNetwork().startAssetDecode());return z.fromBytes(y)}.bind(this),function(x){this.$DecodedAssetRequest3.forEach(function(y){return y.error()});return this.$DecodedAssetRequest10(x)}.bind(this)).then(function(x){this.$DecodedAssetRequest5="done";this.$DecodedAssetRequest1.forEach(function(y){return y.finish()});this.$DecodedAssetRequest11();return x}.bind(this),function(x){this.$DecodedAssetRequest1.forEach(function(y){return y.error()});return this.$DecodedAssetRequest10(x)}.bind(this));return this.$DecodedAssetRequest2};u.prototype.$DecodedAssetRequest10=function(w){this.$DecodedAssetRequest11();this.$DecodedAssetRequest5="error";return c("Promise").reject(w)};u.prototype.$DecodedAssetRequest11=function(){this.$DecodedAssetRequest3.length=0;this.$DecodedAssetRequest1.length=0};var v={requestDecodedAssetOnly:function w(x,y){return r(x).requestAsset(y)},requestRenderer:function w(x,y){return r(x).requestRenderer(y)},hasLoaded:function w(x){return q(x)&&r(x).isLoaded()},clearCache:function w(){h={}}};f.exports=v}),null);